<Window x:Class="Challenge.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Challenge"
        d:DataContext="{d:DesignInstance Type=local:MainViewModel}"
        mc:Ignorable="d"
        Name="CurrencyConversionWindow"
        Title="Celonis C# Developer Challenge" Height="450" Width="800">
    <Window.Resources>
        <Style x:Key="ComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Width" Value="200"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
        <Style x:Key="TextBoxStyle" TargetType="TextBox">
            <Setter Property="Width" Value="100"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
        <Style x:Key="DatePickerStyle" TargetType="DatePicker">
            <Setter Property="Width" Value="200"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
        <Style x:Key="TextBlockStyle" TargetType="TextBlock">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style x:Key="HeaderStyle" TargetType="TextBlock" BasedOn="{StaticResource TextBlockStyle}">
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
    </Window.Resources>
    <Grid>
        <DockPanel Name="MainPanel">
            <!-- Header -->
            <TextBlock Text="Currency Conversion" DockPanel.Dock="Top" Style="{StaticResource HeaderStyle}"/>

            <!-- Source Currency Panel -->
            <StackPanel DockPanel.Dock="Top" Name="SourceCurrencyPanel" Orientation="Horizontal" HorizontalAlignment="Left">
                <TextBox Name="SourceCurrencyTextBox" 
                         Style="{StaticResource TextBoxStyle}" 
                         Text="{Binding Amount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <ComboBox Name="SourceCurrencyComboBox" 
                          Style="{StaticResource ComboBoxStyle}"
                          ItemsSource="{Binding AvailableCurrencies}"
                          SelectedItem="{Binding SelectedSourceCurrency, Mode=TwoWay}"/>
            </StackPanel>

            <!-- Target Currency Panel -->
            <StackPanel DockPanel.Dock="Top" Name="TargetCurrencyPanel" Orientation="Horizontal" HorizontalAlignment="Left">
                <TextBlock Name="LatestAmountTextBlock" 
                           Style="{StaticResource TextBlockStyle}"
                           Text="{Binding LatestConvertedAmount, StringFormat='{}{0:N2}'}"/>
                <ComboBox Name="TargetCurrencyComboBox" 
                          Style="{StaticResource ComboBoxStyle}"
                          ItemsSource="{Binding AvailableCurrencies}"
                          SelectedItem="{Binding SelectedTargetCurrency, Mode=TwoWay}"/>
                <TextBlock Name="LatestDateTextBlock" 
                           Style="{StaticResource TextBlockStyle}"
                           Text="{Binding LatestRateDate, StringFormat='As of {0}'}"/>
            </StackPanel>

            <!-- Time Range Panel -->
            <StackPanel DockPanel.Dock="Top" Name="TimeRangeStackPanel" Orientation="Horizontal" HorizontalAlignment="Left">
                <TextBlock Text="Between" Style="{StaticResource TextBlockStyle}"/>
                <DatePicker Name="StartDatePicker" 
                            Style="{StaticResource DatePickerStyle}"
                            SelectedDate="{Binding StartDate, Mode=TwoWay}"/>
                <TextBlock Text="and" Style="{StaticResource TextBlockStyle}"/>
                <DatePicker Name="EndDatePicker" 
                            Style="{StaticResource DatePickerStyle}"
                            SelectedDate="{Binding EndDate, Mode=TwoWay}"/>
            </StackPanel>

            <!-- Historical Data Grid -->
            <Grid Name="HistoricalDataGrid" Margin="5">
                <DataGrid ItemsSource="{Binding HistoricalRates}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          GridLinesVisibility="All"
                          HeadersVisibility="Column"
                          CanUserSortColumns="True"
                          CanUserResizeColumns="True"
                          AlternatingRowBackground="LightGray">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Date" 
                                            Binding="{Binding Date, StringFormat='{}{0:yyyy-MM-dd}'}" 
                                            Width="*"/>
                        <DataGridTextColumn Header="Rate" 
                                            Binding="{Binding Rate, StringFormat='{}{0:N4}'}" 
                                            Width="*"/>
                        <DataGridTextColumn Header="Converted Amount" 
                                            Binding="{Binding ConvertedAmount, StringFormat='{}{0:N2}'}" 
                                            Width="*"/>
                        <DataGridTextColumn Header="Currency" 
                                            Binding="{Binding Currency}" 
                                            Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </DockPanel>
    </Grid>
</Window>